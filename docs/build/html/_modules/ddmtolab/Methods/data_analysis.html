

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ddmtolab.Methods.data_analysis &mdash; DDMTOLab 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            DDMTOLab
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../demos.html">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../methods.html">Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../problems.html">Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">DDMTOLab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ddmtolab.Methods.data_analysis</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ddmtolab.Methods.data_analysis</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data Analyzer Module for Multi-Task Optimization Experiments</span>

<span class="sd">This module provides a comprehensive analysis and visualization pipeline for</span>
<span class="sd">multi-task optimization experiments, including metric calculation, statistical</span>
<span class="sd">comparison tables, convergence plots, runtime analysis, and Pareto front visualization.</span>

<span class="sd">Classes:</span>
<span class="sd">    MetricResults: Dataclass for storing metric calculation results</span>
<span class="sd">    TableConfig: Dataclass for table generation configuration</span>
<span class="sd">    PlotConfig: Dataclass for plot generation configuration</span>
<span class="sd">    DataAnalyzer: Main class for data analysis pipeline</span>

<span class="sd">Author: Jiangtao Shen</span>
<span class="sd">Email: j.shen5@exeter.ac.uk</span>
<span class="sd">Date: 2025.10.10</span>
<span class="sd">Version: 2.1</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_workbook</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> <span class="n">Alignment</span><span class="p">,</span> <span class="n">Font</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># Import from project modules</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ddmtolab.Methods.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">IGD</span><span class="p">,</span> <span class="n">HV</span><span class="p">,</span> <span class="n">GD</span><span class="p">,</span> <span class="n">IGDp</span><span class="p">,</span> <span class="n">FR</span><span class="p">,</span> <span class="n">CV</span><span class="p">,</span> <span class="n">DeltaP</span><span class="p">,</span> <span class="n">Spread</span><span class="p">,</span> <span class="n">Spacing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ddmtolab.Methods.Algo_Methods.algo_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">nd_sort</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Enums and Constants</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="OptimizationDirection">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.OptimizationDirection">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">OptimizationDirection</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimization direction enumeration.&quot;&quot;&quot;</span>
    <span class="n">MINIMIZE</span> <span class="o">=</span> <span class="s2">&quot;minimize&quot;</span>
    <span class="n">MAXIMIZE</span> <span class="o">=</span> <span class="s2">&quot;maximize&quot;</span></div>



<div class="viewcode-block" id="TableFormat">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.TableFormat">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TableFormat</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Output table format enumeration.&quot;&quot;&quot;</span>
    <span class="n">EXCEL</span> <span class="o">=</span> <span class="s2">&quot;excel&quot;</span>
    <span class="n">LATEX</span> <span class="o">=</span> <span class="s2">&quot;latex&quot;</span></div>



<div class="viewcode-block" id="StatisticType">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticType">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StatisticType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Statistical measure type enumeration.&quot;&quot;&quot;</span>
    <span class="n">MEAN</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span>
    <span class="n">MEDIAN</span> <span class="o">=</span> <span class="s2">&quot;median&quot;</span>
    <span class="n">MAX</span> <span class="o">=</span> <span class="s2">&quot;max&quot;</span>
    <span class="n">MIN</span> <span class="o">=</span> <span class="s2">&quot;min&quot;</span></div>



<span class="c1"># Default color palette for plots</span>
<span class="n">DEFAULT_COLORS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff7f0e&#39;</span><span class="p">,</span> <span class="s1">&#39;#2ca02c&#39;</span><span class="p">,</span> <span class="s1">&#39;#d62728&#39;</span><span class="p">,</span> <span class="s1">&#39;#9467bd&#39;</span><span class="p">,</span>
    <span class="s1">&#39;#8c564b&#39;</span><span class="p">,</span> <span class="s1">&#39;#e377c2&#39;</span><span class="p">,</span> <span class="s1">&#39;#7f7f7f&#39;</span><span class="p">,</span> <span class="s1">&#39;#bcbd22&#39;</span><span class="p">,</span> <span class="s1">&#39;#17becf&#39;</span>
<span class="p">]</span>

<span class="c1"># Default markers for plots</span>
<span class="n">DEFAULT_MARKERS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">]</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Data Classes</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="ScanResult">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.ScanResult">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ScanResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Result of scanning a data directory.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    algorithms : List[str]</span>
<span class="sd">        Sorted list of algorithm names found in the directory.</span>
<span class="sd">    problems : List[str]</span>
<span class="sd">        Sorted list of problem names extracted from filenames.</span>
<span class="sd">    runs : int</span>
<span class="sd">        Number of independent runs per algorithm-problem combination.</span>
<span class="sd">    data_path : Path</span>
<span class="sd">        Path to the scanned data directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">algorithms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">problems</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">runs</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span></div>



<div class="viewcode-block" id="MetricResults">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.MetricResults">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MetricResults</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container for all metric calculation results.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    metric_values : Dict[str, Dict[str, Dict[int, List[np.ndarray]]]]</span>
<span class="sd">        Nested dictionary storing metric values per generation.</span>
<span class="sd">        Structure: metric_values[algorithm][problem][run] = List[np.ndarray]</span>
<span class="sd">        where each np.ndarray contains metric values per generation for each task.</span>
<span class="sd">    best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">        Nested dictionary storing final best metric values.</span>
<span class="sd">        Structure: best_values[algorithm][problem][run] = List[float]</span>
<span class="sd">        where each float is the final best value for each task.</span>
<span class="sd">    objective_values : Dict[str, Dict[str, Dict[int, List[np.ndarray]]]]</span>
<span class="sd">        Nested dictionary storing original objective values.</span>
<span class="sd">        Structure: objective_values[algorithm][problem][run] = List[np.ndarray]</span>
<span class="sd">        where each np.ndarray has shape (n_solutions, n_objectives).</span>
<span class="sd">    runtime : Dict[str, Dict[str, Dict[int, float]]]</span>
<span class="sd">        Nested dictionary storing runtime in seconds.</span>
<span class="sd">        Structure: runtime[algorithm][problem][run] = float</span>
<span class="sd">    max_nfes : Dict[str, Dict[str, List[int]]]</span>
<span class="sd">        Nested dictionary storing maximum number of function evaluations.</span>
<span class="sd">        Structure: max_nfes[algorithm][problem] = List[int] (per task)</span>
<span class="sd">    metric_name : Optional[str]</span>
<span class="sd">        Name of the metric used (e.g., &#39;IGD&#39;, &#39;HV&#39;, or None for single-objective).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metric_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span>
    <span class="n">best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]]</span>
    <span class="n">objective_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]]]</span>
    <span class="n">runtime</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span>
    <span class="n">max_nfes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
    <span class="n">metric_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></div>



<div class="viewcode-block" id="TableConfig">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.TableConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TableConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for table generation.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    table_format : TableFormat</span>
<span class="sd">        Output format (EXCEL or LATEX).</span>
<span class="sd">    statistic_type : StatisticType</span>
<span class="sd">        Type of statistic to display (MEAN, MEDIAN, MAX, MIN).</span>
<span class="sd">    significance_level : float</span>
<span class="sd">        P-value threshold for statistical significance testing.</span>
<span class="sd">        Default: 0.05</span>
<span class="sd">    rank_sum_test : bool</span>
<span class="sd">        Whether to perform Wilcoxon rank-sum test.</span>
<span class="sd">        Default: True</span>
<span class="sd">    save_path : Path</span>
<span class="sd">        Directory path to save output tables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_format</span><span class="p">:</span> <span class="n">TableFormat</span> <span class="o">=</span> <span class="n">TableFormat</span><span class="o">.</span><span class="n">EXCEL</span>
    <span class="n">statistic_type</span><span class="p">:</span> <span class="n">StatisticType</span> <span class="o">=</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span>
    <span class="n">significance_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="n">rank_sum_test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./Results&#39;</span><span class="p">)</span></div>



<div class="viewcode-block" id="PlotConfig">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.PlotConfig">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PlotConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration for plot generation.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    figure_format : str</span>
<span class="sd">        Output figure format (e.g., &#39;pdf&#39;, &#39;png&#39;, &#39;svg&#39;).</span>
<span class="sd">        Default: &#39;pdf&#39;</span>
<span class="sd">    statistic_type : StatisticType</span>
<span class="sd">        Type of statistic for selecting representative run.</span>
<span class="sd">    log_scale : bool</span>
<span class="sd">        Whether to use logarithmic scale for y-axis.</span>
<span class="sd">        Default: False</span>
<span class="sd">    show_pf : bool</span>
<span class="sd">        Whether to show true Pareto front in ND solution plots.</span>
<span class="sd">        Default: True</span>
<span class="sd">    show_nd : bool</span>
<span class="sd">        Whether to filter and show only non-dominated solutions.</span>
<span class="sd">        Default: True</span>
<span class="sd">    save_path : Path</span>
<span class="sd">        Directory path to save output figures.</span>
<span class="sd">    colors : List[str]</span>
<span class="sd">        Color palette for plotting algorithms.</span>
<span class="sd">    markers : List[str]</span>
<span class="sd">        Marker styles for plotting algorithms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">figure_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pdf&#39;</span>
    <span class="n">statistic_type</span><span class="p">:</span> <span class="n">StatisticType</span> <span class="o">=</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span>
    <span class="n">log_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">show_pf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">show_nd</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./Results&#39;</span><span class="p">)</span>
    <span class="n">colors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">DEFAULT_COLORS</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">markers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">DEFAULT_MARKERS</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></div>



<div class="viewcode-block" id="ComparisonResult">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.ComparisonResult">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComparisonResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Result of statistical comparison between algorithms.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    symbol : str</span>
<span class="sd">        Comparison symbol: &#39;+&#39; (better), &#39;-&#39; (worse), &#39;=&#39; (no significant difference).</span>
<span class="sd">    p_value : Optional[float]</span>
<span class="sd">        P-value from statistical test, or None if test not performed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">p_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>



<div class="viewcode-block" id="ComparisonCounts">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.ComparisonCounts">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ComparisonCounts</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aggregated comparison counts for an algorithm.</span>

<span class="sd">    :no-index:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    plus : int</span>
<span class="sd">        Number of significantly better results.</span>
<span class="sd">    minus : int</span>
<span class="sd">        Number of significantly worse results.</span>
<span class="sd">    equal : int</span>
<span class="sd">        Number of statistically equivalent results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">minus</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">equal</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Utility Functions</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="DataUtils">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataUtils">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DataUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility class for data loading and processing operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DataUtils.load_pickle">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataUtils.load_pickle">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_pickle</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load and return a Python object from a pickle file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file_path : Path</span>
<span class="sd">            Path to the pickle file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, Any]</span>
<span class="sd">            Unpickled Python object (typically a dictionary containing</span>
<span class="sd">            &#39;all_objs&#39;, &#39;runtime&#39;, &#39;max_nfes&#39; keys).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FileNotFoundError</span>
<span class="sd">            If the pickle file does not exist.</span>
<span class="sd">        pickle.UnpicklingError</span>
<span class="sd">            If the file cannot be unpickled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataUtils.load_reference">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataUtils.load_reference">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_reference</span><span class="p">(</span>
            <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
            <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_identifier</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
            <span class="n">M</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">D</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">C</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load reference data (Pareto Front or reference point) for a specific problem and task.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        settings : Dict[str, Any]</span>
<span class="sd">            Dictionary containing problem configurations and reference definitions.</span>
<span class="sd">            Expected keys:</span>

<span class="sd">            - problem (str): Contains task definitions</span>
<span class="sd">            - &#39;n_ref&#39; (int, optional): Number of reference points (default: 10000)</span>
<span class="sd">            - &#39;ref_path&#39; (str, optional): Path to reference files (default: &#39;./MOReference&#39;)</span>

<span class="sd">        problem : str</span>
<span class="sd">            Name of the problem (e.g., &quot;DTLZ1&quot;, &quot;DTLZ2&quot;).</span>
<span class="sd">        task_identifier : Union[str, int]</span>
<span class="sd">            Task identifier - either task name (str like &quot;T1&quot;) or index (int like 0).</span>
<span class="sd">        M : int</span>
<span class="sd">            Number of objectives (required).</span>
<span class="sd">        D : int, optional</span>
<span class="sd">            Number of decision variables (dimension).</span>
<span class="sd">        C : int, optional</span>
<span class="sd">            Number of constraints (default: 0).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[np.ndarray]</span>
<span class="sd">            Reference data with shape (n_points, M), or None if not available.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Supports three types of reference definitions:</span>

<span class="sd">        1. Callable: Function that returns reference data</span>

<span class="sd">           - Must accept parameter N (number of reference points)</span>
<span class="sd">           - Must accept parameter M (number of objectives)</span>
<span class="sd">           - May optionally accept parameters D, C</span>
<span class="sd">           - Example signatures: ``func(N, M)``, ``func(N, M, D)``, ``func(N, M, D, C)``</span>

<span class="sd">        2. String: File path to .npy or .csv reference file</span>
<span class="sd">        3. Array-like: Direct reference data (list, tuple, np.ndarray)</span>

<span class="sd">        If &#39;all_tasks&#39; key is present instead of individual task keys, the same</span>
<span class="sd">        reference data will be used for all tasks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert task index to task name if necessary</span>
        <span class="n">task_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;T</span><span class="si">{</span><span class="n">task_identifier</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">task_identifier</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">task_identifier</span>

        <span class="c1"># Check if problem exists in settings</span>
        <span class="k">if</span> <span class="n">problem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">settings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Problem &#39;</span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">&#39; not found in settings&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">problem_settings</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="n">problem</span><span class="p">]</span>

        <span class="c1"># Check if task exists for this problem</span>
        <span class="k">if</span> <span class="n">task_name</span> <span class="ow">in</span> <span class="n">problem_settings</span><span class="p">:</span>
            <span class="n">ref_definition</span> <span class="o">=</span> <span class="n">problem_settings</span><span class="p">[</span><span class="n">task_name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;all_tasks&#39;</span> <span class="ow">in</span> <span class="n">problem_settings</span><span class="p">:</span>
            <span class="c1"># Use the same reference for all tasks</span>
            <span class="n">ref_definition</span> <span class="o">=</span> <span class="n">problem_settings</span><span class="p">[</span><span class="s1">&#39;all_tasks&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Task &#39;</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">&#39; and &#39;all_tasks&#39; not found for problem &#39;</span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Case 1: Callable function</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">):</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_ref&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">)</span>
                <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">num_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># func(N, M)</span>
                    <span class="k">return</span> <span class="n">ref_definition</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">num_params</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># func(N, M, D)</span>
                    <span class="k">if</span> <span class="n">D</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: D not provided for </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">, using 0&quot;</span><span class="p">)</span>
                        <span class="n">D</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">return</span> <span class="n">ref_definition</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">num_params</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1"># func(N, M, D, C)</span>
                    <span class="k">if</span> <span class="n">D</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: D not provided for </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">, using 0&quot;</span><span class="p">)</span>
                        <span class="n">D</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">return</span> <span class="n">ref_definition</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Warning: Unexpected number of parameters (</span><span class="si">{</span><span class="n">num_params</span><span class="si">}</span><span class="s2">) for reference function </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">None</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Failed to call reference function for </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Case 2: String (file path or file name)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DataUtils</span><span class="o">.</span><span class="n">_load_reference_from_file</span><span class="p">(</span>
                <span class="n">settings</span><span class="p">,</span>
                <span class="n">ref_definition</span><span class="p">,</span>
                <span class="n">problem</span><span class="p">,</span>
                <span class="n">task_name</span>
            <span class="p">)</span>

        <span class="c1"># Case 3: Array-like (list, tuple, numpy array)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="n">reference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">)</span>
            <span class="c1"># Ensure it&#39;s at least 2D</span>
            <span class="k">if</span> <span class="n">reference</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">reference</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Unknown reference definition type for </span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_load_reference_from_file</span><span class="p">(</span>
            <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
            <span class="n">ref_definition</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load reference data from file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        settings : Dict[str, Any]</span>
<span class="sd">            Settings dictionary containing &#39;ref_path&#39;.</span>
<span class="sd">        ref_definition : str</span>
<span class="sd">            File path or filename.</span>
<span class="sd">        problem : str</span>
<span class="sd">            Problem name for alternative path construction.</span>
<span class="sd">        task_name : str</span>
<span class="sd">            Task name for alternative path construction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[np.ndarray]</span>
<span class="sd">            Loaded reference data or None if loading fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ref_path</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ref_path&#39;</span><span class="p">,</span> <span class="s1">&#39;./MOReference&#39;</span><span class="p">)</span>

        <span class="c1"># Construct full path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">ref_definition</span><span class="p">):</span>
            <span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_path</span><span class="p">,</span> <span class="n">ref_definition</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">full_path</span> <span class="o">=</span> <span class="n">ref_definition</span>

        <span class="c1"># Try to load the file</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">full_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">full_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.csv&#39;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Unsupported file format for &#39;</span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="c1"># Try alternative naming conventions</span>
            <span class="n">base_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">problem</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">task_name</span><span class="si">}</span><span class="s2">_ref&quot;</span>

            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="s1">&#39;.csv&#39;</span><span class="p">]:</span>
                <span class="n">alt_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_path</span><span class="p">,</span> <span class="n">base_name</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">alt_path</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.npy&#39;</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">alt_path</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">alt_path</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading file &#39;</span><span class="si">{</span><span class="n">alt_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: File not found: &#39;</span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error loading reference data from file &#39;</span><span class="si">{</span><span class="n">full_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="DataUtils.get_metric_direction">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataUtils.get_metric_direction">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_metric_direction</span><span class="p">(</span><span class="n">metric_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">OptimizationDirection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine optimization direction based on metric type (Version 2 - More maintainable).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        metric_name : Optional[str]</span>
<span class="sd">            Name of the metric or None for single-objective.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OptimizationDirection</span>
<span class="sd">            MINIMIZE or MAXIMIZE based on the metric&#39;s sign attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">metric_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span>

        <span class="c1"># Metric sign mapping (based on your code)</span>
        <span class="c1"># sign = -1 means minimize, sign = 1 means maximize</span>
        <span class="n">metric_signs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;IGD&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Inverted Generational Distance (minimize)</span>
            <span class="s1">&#39;HV&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Hypervolume (maximize)</span>
            <span class="s1">&#39;IGDp&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># IGD+ (minimize)</span>
            <span class="s1">&#39;GD&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Generational Distance (minimize)</span>
            <span class="s1">&#39;DeltaP&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Delta_p (minimize)</span>
            <span class="s1">&#39;Spacing&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Spacing (minimize)</span>
            <span class="s1">&#39;Spread&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Spread (minimize)</span>
            <span class="s1">&#39;FR&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Feasibility Rate (maximize)</span>
            <span class="s1">&#39;CV&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Constraint Violation (minimize)</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">metric_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metric_signs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unsupported metric: </span><span class="si">{</span><span class="n">metric_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_signs</span><span class="p">[</span><span class="n">metric_name</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MAXIMIZE</span> <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Statistics Module</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="StatisticsCalculator">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticsCalculator">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">StatisticsCalculator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for statistical calculations and hypothesis testing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StatisticsCalculator.calculate_statistic">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticsCalculator.calculate_statistic">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_statistic</span><span class="p">(</span>
            <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
            <span class="n">statistic_type</span><span class="p">:</span> <span class="n">StatisticType</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate a statistical measure and optional standard deviation from data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : List[float]</span>
<span class="sd">            List of numeric values to compute statistics from.</span>
<span class="sd">        statistic_type : StatisticType</span>
<span class="sd">            Type of statistic to calculate (MEAN, MEDIAN, MAX, MIN).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple[float, Optional[float]]</span>
<span class="sd">            Tuple of (statistic_value, std_value).</span>
<span class="sd">            std_value is only returned for MEAN, None otherwise.</span>
<span class="sd">            Returns (np.nan, np.nan) for empty data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">if</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span><span class="p">:</span>
            <span class="n">stat_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">std_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.0</span>
            <span class="k">return</span> <span class="n">stat_value</span><span class="p">,</span> <span class="n">std_value</span>
        <span class="k">elif</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEDIAN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MAX</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MIN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span></div>


<div class="viewcode-block" id="StatisticsCalculator.perform_rank_sum_test">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticsCalculator.perform_rank_sum_test">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">perform_rank_sum_test</span><span class="p">(</span>
            <span class="n">algo_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
            <span class="n">base_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
            <span class="n">significance_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span> <span class="o">=</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComparisonResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform Wilcoxon rank-sum test to compare two algorithms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        algo_data : List[float]</span>
<span class="sd">            Data from the algorithm being tested.</span>
<span class="sd">        base_data : List[float]</span>
<span class="sd">            Data from the baseline algorithm.</span>
<span class="sd">        significance_level : float, optional</span>
<span class="sd">            P-value threshold for significance (default: 0.05).</span>
<span class="sd">        direction : OptimizationDirection, optional</span>
<span class="sd">            Optimization direction (MINIMIZE or MAXIMIZE).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ComparisonResult</span>
<span class="sd">            Result containing comparison symbol and p-value.</span>
<span class="sd">            Symbol: &#39;+&#39; (better), &#39;-&#39; (worse), &#39;=&#39; (no significant difference).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">algo_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ComparisonResult</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">p_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ranksums</span><span class="p">(</span><span class="n">algo_data</span><span class="p">,</span> <span class="n">base_data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">significance_level</span><span class="p">:</span>
                <span class="n">algo_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">algo_data</span><span class="p">)</span>
                <span class="n">base_median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">base_data</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span><span class="p">:</span>
                    <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span> <span class="k">if</span> <span class="n">algo_median</span> <span class="o">&lt;</span> <span class="n">base_median</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span> <span class="k">if</span> <span class="n">algo_median</span> <span class="o">&gt;</span> <span class="n">base_median</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span>

            <span class="k">return</span> <span class="n">ComparisonResult</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span> <span class="n">p_value</span><span class="o">=</span><span class="n">p_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ComparisonResult</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">p_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="StatisticsCalculator.collect_task_data">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticsCalculator.collect_task_data">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">collect_task_data</span><span class="p">(</span>
            <span class="n">all_best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collect non-NaN values from all runs for a specific algorithm-problem-task combination.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        all_best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">            Nested dictionary containing best metric values.</span>
<span class="sd">        algo : str</span>
<span class="sd">            Algorithm name.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name.</span>
<span class="sd">        task_idx : int</span>
<span class="sd">            Task index (0-based).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[float]</span>
<span class="sd">            List of non-NaN metric values from all runs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">all_best_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">all_best_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">][</span><span class="n">task_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="StatisticsCalculator.select_representative_run">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.StatisticsCalculator.select_representative_run">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">select_representative_run</span><span class="p">(</span>
            <span class="n">all_best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">statistic_type</span><span class="p">:</span> <span class="n">StatisticType</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select a representative run based on the specified statistic type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        all_best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">            Nested dictionary containing best metric values.</span>
<span class="sd">        algo : str</span>
<span class="sd">            Algorithm name.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name.</span>
<span class="sd">        task_idx : int</span>
<span class="sd">            Task index (0-based).</span>
<span class="sd">        statistic_type : StatisticType</span>
<span class="sd">            Type of statistic (MEAN returns None as all runs are used).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[int]</span>
<span class="sd">            Run number of the representative run, or None if MEAN or no valid data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Collect final values from all runs</span>
        <span class="n">final_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">runs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">all_best_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">all_best_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">][</span><span class="n">task_idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                <span class="n">final_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">runs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">final_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">final_values</span><span class="p">)</span>
        <span class="n">runs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">runs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEDIAN</span><span class="p">:</span>
            <span class="n">target_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">final_values</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">final_values</span> <span class="o">-</span> <span class="n">target_value</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MAX</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">final_values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MIN</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">final_values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">runs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Table Generator Module</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="TableGenerator">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.TableGenerator">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TableGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating comparison tables in Excel and LaTeX formats.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TableConfig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize TableGenerator with configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config : TableConfig</span>
<span class="sd">            Configuration object for table generation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

<div class="viewcode-block" id="TableGenerator.generate">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.TableGenerator.generate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">all_best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">metric_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate comparison table with statistical analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        all_best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">            Nested dictionary containing best metric values.</span>
<span class="sd">            Structure: all_best_values[algorithm][problem][run] = List[float]</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            List of algorithm names in display order.</span>
<span class="sd">            The last algorithm is treated as the baseline for comparisons.</span>
<span class="sd">        metric_name : Optional[str], optional</span>
<span class="sd">            Metric name to determine optimization direction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[pd.DataFrame, str]</span>
<span class="sd">            DataFrame for Excel format, LaTeX string for LaTeX format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract problems and determine task count</span>
        <span class="c1"># problems = sorted(all_best_values[algorithm_order[0]].keys())</span>
        <span class="n">problems</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_best_values</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                          <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

        <span class="c1"># Determine optimization direction</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">DataUtils</span><span class="o">.</span><span class="n">get_metric_direction</span><span class="p">(</span><span class="n">metric_name</span><span class="p">)</span>

        <span class="c1"># Generate data rows</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">comparison_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_data_rows</span><span class="p">(</span><span class="n">all_best_values</span><span class="p">,</span> <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">problems</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>

        <span class="c1"># Generate and save table</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">table_format</span> <span class="o">==</span> <span class="n">TableFormat</span><span class="o">.</span><span class="n">EXCEL</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_excel_table</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">comparison_counts</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_latex_table</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">comparison_counts</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_data_rows</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">all_best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">problems</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ComparisonCounts</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate table rows with formatted metric values and statistical comparisons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        all_best_values : Dict</span>
<span class="sd">            Best metric values dictionary.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            Algorithm display order.</span>
<span class="sd">        problems : List[str]</span>
<span class="sd">            List of problem names.</span>
<span class="sd">        direction : OptimizationDirection</span>
<span class="sd">            Optimization direction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple[List[Dict[str, Any]], Dict[str, ComparisonCounts]]</span>
<span class="sd">            Tuple of (rows, comparison_counts).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_algo</span> <span class="o">=</span> <span class="n">algorithm_order</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">comparison_counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="n">ComparisonCounts</span><span class="p">()</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>

        <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">problems</span><span class="p">:</span>
            <span class="c1"># Get the number of tasks of the problem</span>
            <span class="n">first_algo</span> <span class="o">=</span> <span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">first_run</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_best_values</span><span class="p">[</span><span class="n">first_algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">num_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_best_values</span><span class="p">[</span><span class="n">first_algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">first_run</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">task_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">):</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Problem&#39;</span><span class="p">:</span> <span class="n">prob</span><span class="p">,</span> <span class="s1">&#39;Task&#39;</span><span class="p">:</span> <span class="n">task_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span>

                <span class="c1"># Collect baseline data</span>
                <span class="n">base_data</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">collect_task_data</span><span class="p">(</span>
                    <span class="n">all_best_values</span><span class="p">,</span> <span class="n">base_algo</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span>
                <span class="p">)</span>

                <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">:</span>
                    <span class="n">algo_data</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">collect_task_data</span><span class="p">(</span>
                        <span class="n">all_best_values</span><span class="p">,</span> <span class="n">algo</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span>
                    <span class="p">)</span>

                    <span class="n">stat_value</span><span class="p">,</span> <span class="n">std_value</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">calculate_statistic</span><span class="p">(</span>
                        <span class="n">algo_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span>
                    <span class="p">)</span>

                    <span class="n">symbol</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">rank_sum_test</span> <span class="ow">and</span> <span class="n">algo</span> <span class="o">!=</span> <span class="n">base_algo</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">perform_rank_sum_test</span><span class="p">(</span>
                            <span class="n">algo_data</span><span class="p">,</span> <span class="n">base_data</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">significance_level</span><span class="p">,</span> <span class="n">direction</span>
                        <span class="p">)</span>
                        <span class="n">symbol</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">symbol</span>

                        <span class="c1"># Update comparison counts</span>
                        <span class="k">if</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">comparison_counts</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>
                                <span class="n">comparison_counts</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="o">.</span><span class="n">plus</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                                <span class="n">comparison_counts</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="o">.</span><span class="n">minus</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">comparison_counts</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="o">.</span><span class="n">equal</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="n">cell_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_cell_content</span><span class="p">(</span><span class="n">stat_value</span><span class="p">,</span> <span class="n">std_value</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>
                    <span class="n">row</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_content</span>

                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">comparison_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_format_cell_content</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">stat_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">std_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
            <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format a table cell with statistic value, optional std deviation, and comparison symbol.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stat_value : float</span>
<span class="sd">            Statistical value.</span>
<span class="sd">        std_value : Optional[float]</span>
<span class="sd">            Standard deviation (or None).</span>
<span class="sd">        symbol : str</span>
<span class="sd">            Comparison symbol.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            Formatted cell content string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">stat_value</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;N/A&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">table_format</span> <span class="o">==</span> <span class="n">TableFormat</span><span class="o">.</span><span class="n">EXCEL</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span><span class="p">:</span>
                <span class="n">cell_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_value</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">std_value</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_value</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">if</span> <span class="n">symbol</span><span class="p">:</span>
                <span class="n">cell_content</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># LaTeX format</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span> <span class="o">==</span> <span class="n">StatisticType</span><span class="o">.</span><span class="n">MEAN</span><span class="p">:</span>
                <span class="n">stat_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_value</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e-&#39;</span><span class="p">,</span> <span class="s1">&#39;e$-$&#39;</span><span class="p">)</span>
                <span class="n">std_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">std_value</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e-&#39;</span><span class="p">,</span> <span class="s1">&#39;e$-$&#39;</span><span class="p">)</span>
                <span class="n">cell_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_str</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">std_str</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stat_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_value</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e-&#39;</span><span class="p">,</span> <span class="s1">&#39;e$-$&#39;</span><span class="p">)</span>
                <span class="n">cell_content</span> <span class="o">=</span> <span class="n">stat_str</span>

            <span class="k">if</span> <span class="n">symbol</span><span class="p">:</span>
                <span class="n">symbol_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;+&#39;</span><span class="p">:</span> <span class="s1">&#39;~$+$&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span> <span class="s1">&#39;~$-$&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span> <span class="s1">&#39;~=&#39;</span><span class="p">}</span>
                <span class="n">cell_content</span> <span class="o">+=</span> <span class="n">symbol_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cell_content</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_best_value_in_row</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">row</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the algorithm with the best performance in a table row.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        row : Dict[str, Any]</span>
<span class="sd">            Dictionary mapping algorithm names to formatted cell values.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            List of algorithm names.</span>
<span class="sd">        direction : OptimizationDirection</span>
<span class="sd">            Optimization direction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[str]</span>
<span class="sd">            Name of the best-performing algorithm or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">best_val</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">best_algo</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">:</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cell</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val_str</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;e$-$&#39;</span><span class="p">,</span> <span class="s1">&#39;e-&#39;</span><span class="p">)</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val_str</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">best_val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">best_val</span><span class="p">:</span>
                            <span class="n">best_val</span> <span class="o">=</span> <span class="n">val</span>
                            <span class="n">best_algo</span> <span class="o">=</span> <span class="n">algo</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">best_val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">best_val</span><span class="p">:</span>
                            <span class="n">best_val</span> <span class="o">=</span> <span class="n">val</span>
                            <span class="n">best_algo</span> <span class="o">=</span> <span class="n">algo</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">return</span> <span class="n">best_algo</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_excel_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">comparison_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ComparisonCounts</span><span class="p">],</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save a formatted Excel table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rows : List[Dict[str, Any]]</span>
<span class="sd">            Table row data.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            Algorithm display order.</span>
<span class="sd">        comparison_counts : Dict[str, ComparisonCounts]</span>
<span class="sd">            Comparison result counts.</span>
<span class="sd">        direction : OptimizationDirection</span>
<span class="sd">            Optimization direction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            DataFrame containing the table data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Append summary row</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">rank_sum_test</span><span class="p">:</span>
            <span class="n">summary_row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Problem&#39;</span><span class="p">:</span> <span class="s1">&#39;+/-/=&#39;</span><span class="p">,</span> <span class="s1">&#39;Task&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">counts</span> <span class="o">=</span> <span class="n">comparison_counts</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span>
                <span class="n">summary_row</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">plus</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">minus</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">equal</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">summary_row</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;Base&#39;</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summary_row</span><span class="p">)</span>

        <span class="c1"># Create DataFrame</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Problem&#39;</span><span class="p">,</span> <span class="s1">&#39;Task&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">algorithm_order</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>

        <span class="c1"># Save and format</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;results_table_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.xlsx&#39;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Apply Excel formatting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_excel_formatting</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Excel table saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_excel_formatting</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
            <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply formatting to Excel workbook.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        output_file : Path</span>
<span class="sd">            Path to Excel file.</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">            DataFrame for row count reference.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            Algorithm names.</span>
<span class="sd">        direction : OptimizationDirection</span>
<span class="sd">            Optimization direction for best value highlighting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

        <span class="c1"># Define styles</span>
        <span class="n">thin_border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
            <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
            <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
            <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">normal_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">bold_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Apply formatting and auto-adjust column widths</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">max_length</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">column_letter</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">column_letter</span>

            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">column</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">normal_font</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                        <span class="n">cell_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">cell_length</span> <span class="o">&gt;</span> <span class="n">max_length</span><span class="p">:</span>
                            <span class="n">max_length</span> <span class="o">=</span> <span class="n">cell_length</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">column_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="c1"># Bold the best value in each data row</span>
        <span class="n">num_data_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">rank_sum_test</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_data_rows</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">best_val</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">best_col</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">algo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col_idx</span><span class="p">)</span>
                <span class="n">cell_value</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span>

                <span class="k">if</span> <span class="n">cell_value</span> <span class="ow">and</span> <span class="n">cell_value</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">val_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cell_value</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val_str</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">OptimizationDirection</span><span class="o">.</span><span class="n">MINIMIZE</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">best_val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">best_val</span><span class="p">:</span>
                                <span class="n">best_val</span> <span class="o">=</span> <span class="n">val</span>
                                <span class="n">best_col</span> <span class="o">=</span> <span class="n">col_idx</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">best_val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">best_val</span><span class="p">:</span>
                                <span class="n">best_val</span> <span class="o">=</span> <span class="n">val</span>
                                <span class="n">best_col</span> <span class="o">=</span> <span class="n">col_idx</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">if</span> <span class="n">best_col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row_idx</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">best_col</span><span class="p">)</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">bold_font</span>

        <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_latex_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">comparison_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ComparisonCounts</span><span class="p">],</span>
            <span class="n">direction</span><span class="p">:</span> <span class="n">OptimizationDirection</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save a LaTeX-formatted table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rows : List[Dict[str, Any]]</span>
<span class="sd">            Table row data.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            Algorithm display order.</span>
<span class="sd">        comparison_counts : Dict[str, ComparisonCounts]</span>
<span class="sd">            Comparison result counts.</span>
<span class="sd">        direction : OptimizationDirection</span>
<span class="sd">            Optimization direction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            LaTeX table string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

        <span class="c1"># Build table structure</span>
        <span class="n">num_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">col_format</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_cols</span><span class="p">)</span>
        <span class="n">col_format</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">col_format</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span>

        <span class="c1"># Initialize LaTeX table</span>
        <span class="n">latex_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin{table*}[htbp]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">renewcommand{</span><span class="se">\\</span><span class="s2">arraystretch}</span><span class="si">{1.2}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">centering</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">caption{Your caption here}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">label{tab:results}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">resizebox{1.0</span><span class="se">\\</span><span class="s2">textwidth}{!}{</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{</span><span class="s2">tabular</span><span class="se">}}{{</span><span class="si">{</span><span class="n">col_format</span><span class="si">}</span><span class="se">}}\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hline</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Header row</span>
        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;Problem &amp; Task &amp; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &amp; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\\\\\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="n">header</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hline</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Data rows</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">best_algo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_best_value_in_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>

            <span class="n">row_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Problem&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp; </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Task&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">:</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">algo</span> <span class="o">==</span> <span class="n">best_algo</span><span class="p">:</span>
                    <span class="n">cell</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textbf</span><span class="se">{{</span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
                <span class="n">row_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; &amp; </span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">row_str</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="se">\\\\\n</span><span class="s2">&quot;</span>
            <span class="n">latex_str</span> <span class="o">+=</span> <span class="n">row_str</span>
            <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hline</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Summary row</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">rank_sum_test</span><span class="p">:</span>
            <span class="n">summary_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">multicolumn</span><span class="si">{2}</span><span class="s2">{|c|}{+/$-$/=}&quot;</span>
            <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">counts</span> <span class="o">=</span> <span class="n">comparison_counts</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span>
                <span class="n">summary_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; &amp; </span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">plus</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">minus</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">counts</span><span class="o">.</span><span class="n">equal</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">summary_str</span> <span class="o">+=</span> <span class="s2">&quot; &amp; Base </span><span class="se">\\\\\n</span><span class="s2">&quot;</span>
            <span class="n">latex_str</span> <span class="o">+=</span> <span class="n">summary_str</span>
            <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hline</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{tabular}</span><span class="s2">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">latex_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end{table*}</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Save to file</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;results_table_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">.tex&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">latex_str</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LaTeX table saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">latex_str</span></div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Plot Generator Module</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="PlotGenerator">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.PlotGenerator">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PlotGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for generating various visualization plots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">PlotConfig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize PlotGenerator with configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        config : PlotConfig</span>
<span class="sd">            Configuration object for plot generation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

<div class="viewcode-block" id="PlotGenerator.plot_convergence_curves">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.PlotGenerator.plot_convergence_curves">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_convergence_curves</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">metric_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
            <span class="n">best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">max_nfes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">metric_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save convergence curve plots for all algorithms, problems, and tasks.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        metric_values : Dict[str, Dict[str, Dict[int, Any]]]</span>
<span class="sd">            Metric values per generation.</span>
<span class="sd">            Structure: metric_values[algorithm][problem][run] = List[np.ndarray]</span>
<span class="sd">        best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">            Best metric values for representative run selection.</span>
<span class="sd">        max_nfes : Dict[str, Dict[str, List[int]]]</span>
<span class="sd">            Maximum number of function evaluations per task.</span>
<span class="sd">            Structure: max_nfes[algorithm][problem] = List[int]</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            List of algorithm names to plot.</span>
<span class="sd">        metric_name : Optional[str], optional</span>
<span class="sd">            Metric name for y-axis label.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figures to disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">problems</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">metric_values</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">problems</span><span class="p">:</span>
            <span class="n">first_run_data</span> <span class="o">=</span> <span class="n">best_values</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">prob</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">num_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_run_data</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">task_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_tasks</span><span class="p">):</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_convergence_figure</span><span class="p">(</span>
                    <span class="n">num_tasks</span><span class="p">,</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">best_values</span><span class="p">,</span> <span class="n">max_nfes</span><span class="p">,</span>
                    <span class="n">algorithm_order</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="n">metric_name</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">num_tasks</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">output_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">figure_format</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">-Task</span><span class="si">{</span><span class="n">task_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">figure_format</span><span class="si">}</span><span class="s1">&#39;</span>

                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All convergence plots saved to: </span><span class="si">{</span><span class="n">save_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_create_convergence_figure</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">num_tasks</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">metric_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
            <span class="n">best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
            <span class="n">max_nfes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">metric_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a single convergence curve figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_tasks : int</span>
<span class="sd">            Total number of tasks.</span>
<span class="sd">        metric_values : Dict</span>
<span class="sd">            Metric values dictionary.</span>
<span class="sd">        best_values : Dict</span>
<span class="sd">            Best values dictionary.</span>
<span class="sd">        max_nfes : Dict</span>
<span class="sd">            Max NFEs dictionary.</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            Algorithm order.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name.</span>
<span class="sd">        task_idx : int</span>
<span class="sd">            Task index.</span>
<span class="sd">        metric_name : Optional[str]</span>
<span class="sd">            Metric name for label.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plt.Figure</span>
<span class="sd">            Matplotlib figure object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">algo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">):</span>
            <span class="n">selected_run</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">select_representative_run</span><span class="p">(</span>
                <span class="n">best_values</span><span class="p">,</span> <span class="n">algo</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span>
            <span class="p">)</span>

            <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_convergence_curve</span><span class="p">(</span><span class="n">metric_values</span><span class="p">,</span> <span class="n">algo</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="n">selected_run</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">nfes</span> <span class="o">=</span> <span class="n">max_nfes</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">task_idx</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nfes</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">))</span>
            <span class="n">marker_interval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">algo</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">colors</span><span class="p">)],</span>
                <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">markers</span><span class="p">[</span><span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">markers</span><span class="p">)],</span>
                <span class="n">markevery</span><span class="o">=</span><span class="n">marker_interval</span><span class="p">,</span>
                <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">log_scale</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

        <span class="c1"># Apply scientific notation for large values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scientific_notation</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">y_label</span> <span class="o">=</span> <span class="n">metric_name</span> <span class="k">if</span> <span class="n">metric_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;Objective Value&#39;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;NFEs&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">num_tasks</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1"> - Task </span><span class="si">{</span><span class="n">task_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_convergence_curve</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">metric_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
            <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract convergence curve for a specific configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        metric_values : Dict</span>
<span class="sd">            Metric values dictionary.</span>
<span class="sd">        algo : str</span>
<span class="sd">            Algorithm name.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name.</span>
<span class="sd">        task_idx : int</span>
<span class="sd">            Task index.</span>
<span class="sd">        run : Optional[int]</span>
<span class="sd">            Specific run number (None for mean across runs).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">            Convergence curve values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">metric_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">][</span><span class="n">task_idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_curves</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">metric_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">metric_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">r</span><span class="p">][</span><span class="n">task_idx</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">all_curves</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_curves</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

            <span class="n">min_len</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_curves</span><span class="p">)</span>
            <span class="n">truncated_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[:</span><span class="n">min_len</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_curves</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">truncated_curves</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_scientific_notation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply scientific notation to axes if values exceed threshold.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : plt.Axes</span>
<span class="sd">            Matplotlib axes object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">axis_name</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">lim</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)]:</span>
            <span class="k">if</span> <span class="n">lim</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">(</span><span class="n">useMathText</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">formatter</span><span class="o">.</span><span class="n">set_powerlimits</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_name</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<div class="viewcode-block" id="PlotGenerator.plot_runtime">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.PlotGenerator.plot_runtime">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_runtime</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">runtime</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save a bar plot showing average runtime comparison.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        runtime : Dict[str, Dict[str, Dict[int, float]]]</span>
<span class="sd">            Runtime dictionary.</span>
<span class="sd">            Structure: runtime[algorithm][problem][run] = float (seconds)</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            List of algorithm names in display order.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figure to disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">problems</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">runtime</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                          <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">save_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>

        <span class="n">n_algorithms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">)</span>
        <span class="n">n_problems</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">problems</span><span class="p">)</span>
        <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">n_algorithms</span>
        <span class="n">x_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_problems</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">algo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">algorithm_order</span><span class="p">):</span>
            <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">stds</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">problems</span><span class="p">:</span>
                <span class="n">runtimes</span> <span class="o">=</span> <span class="p">[</span><span class="n">runtime</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">runtime</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
                <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">runtimes</span><span class="p">))</span>

                <span class="c1"># Only calculate std if there are at least 2 data points</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">runtimes</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># No error bar for single data point</span>

            <span class="n">x_offset</span> <span class="o">=</span> <span class="n">x_groups</span> <span class="o">+</span> <span class="p">(</span><span class="n">idx</span> <span class="o">-</span> <span class="n">n_algorithms</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">bar_width</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                <span class="n">x_offset</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span>
                <span class="n">yerr</span><span class="o">=</span><span class="n">stds</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">algo</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">colors</span><span class="p">)],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                <span class="n">error_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s1">&#39;ecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
            <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Runtime (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_groups</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">problems</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">output_file</span> <span class="o">=</span> <span class="n">save_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;runtime_comparison.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">figure_format</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime plot saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotGenerator.plot_nd_solutions">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.PlotGenerator.plot_nd_solutions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_nd_solutions</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">best_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]],</span>
            <span class="n">objective_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]]],</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
            <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save non-dominated solution plots.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        best_values : Dict[str, Dict[str, Dict[int, List[float]]]]</span>
<span class="sd">            Best values for representative run selection.</span>
<span class="sd">        objective_values : Dict[str, Dict[str, Dict[int, List[np.ndarray]]]]</span>
<span class="sd">            Original objective values.</span>
<span class="sd">            Structure: objective_values[algorithm][problem][run] = List[np.ndarray]</span>
<span class="sd">            where each np.ndarray has shape (n_solutions, n_objectives).</span>
<span class="sd">        algorithm_order : List[str]</span>
<span class="sd">            List of algorithm names.</span>
<span class="sd">        settings : Optional[Dict[str, Any]], optional</span>
<span class="sd">            Problem settings for loading true Pareto fronts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figures to disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nd_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;ND_Solutions&#39;</span>
        <span class="n">nd_folder</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">problems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_values</span><span class="p">[</span><span class="n">algorithm_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algorithm_order</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">problems</span><span class="p">:</span>
                <span class="n">first_run</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">n_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">objective_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">first_run</span><span class="p">])</span>

                <span class="k">for</span> <span class="n">task_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">):</span>
                    <span class="n">first_run_objs</span> <span class="o">=</span> <span class="n">objective_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">first_run</span><span class="p">][</span><span class="n">task_idx</span><span class="p">]</span>
                    <span class="n">n_objectives</span> <span class="o">=</span> <span class="n">first_run_objs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">n_objectives</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="n">selected_run</span> <span class="o">=</span> <span class="n">StatisticsCalculator</span><span class="o">.</span><span class="n">select_representative_run</span><span class="p">(</span>
                        <span class="n">best_values</span><span class="p">,</span> <span class="n">algo</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">statistic_type</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">selected_run</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">selected_run</span> <span class="o">=</span> <span class="mi">1</span>

                    <span class="n">objectives</span> <span class="o">=</span> <span class="n">objective_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">selected_run</span><span class="p">][</span><span class="n">task_idx</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">objectives</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="c1"># Filter non-dominated solutions if requested</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">show_nd</span><span class="p">:</span>
                        <span class="n">front_no</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">nd_sort</span><span class="p">(</span><span class="n">objectives</span><span class="p">,</span> <span class="n">objectives</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">nd_solutions</span> <span class="o">=</span> <span class="n">objectives</span><span class="p">[</span><span class="n">front_no</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">nd_solutions</span> <span class="o">=</span> <span class="n">objectives</span>

                    <span class="c1"># Load true Pareto front if requested</span>
                    <span class="n">true_pf</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">show_pf</span> <span class="ow">and</span> <span class="n">settings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">true_pf</span> <span class="o">=</span> <span class="n">DataUtils</span><span class="o">.</span><span class="n">load_reference</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">n_objectives</span><span class="p">)</span>

                    <span class="c1"># Create appropriate plot based on number of objectives</span>
                    <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_nd_plot</span><span class="p">(</span><span class="n">nd_solutions</span><span class="p">,</span> <span class="n">true_pf</span><span class="p">,</span> <span class="n">n_objectives</span><span class="p">,</span> <span class="n">n_tasks</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">task_idx</span><span class="p">,</span> <span class="n">algo</span><span class="p">)</span>

                    <span class="c1"># Save figure</span>
                    <span class="k">if</span> <span class="n">n_tasks</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">algo</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">figure_format</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">-Task</span><span class="si">{</span><span class="n">task_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">algo</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">figure_format</span><span class="si">}</span><span class="s1">&#39;</span>

                    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nd_folder</span> <span class="o">/</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All non-dominated solutions plots saved to: </span><span class="si">{</span><span class="n">nd_folder</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_create_nd_plot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">nd_solutions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
            <span class="n">true_pf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
            <span class="n">n_objectives</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">n_tasks</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">task_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">algo</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a non-dominated solution plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nd_solutions : np.ndarray</span>
<span class="sd">            Non-dominated solutions array with shape (n_solutions, n_objectives).</span>
<span class="sd">        true_pf : Optional[np.ndarray]</span>
<span class="sd">            True Pareto front array.</span>
<span class="sd">        n_objectives : int</span>
<span class="sd">            Number of objectives.</span>
<span class="sd">        n_tasks : int</span>
<span class="sd">            Total number of tasks.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name.</span>
<span class="sd">        task_idx : int</span>
<span class="sd">            Task index.</span>
<span class="sd">        algo : str</span>
<span class="sd">            Algorithm name.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        plt.Figure</span>
<span class="sd">            Matplotlib figure object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">n_objectives</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">true_pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">true_pf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">true_pf</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">sorted_pf</span> <span class="o">=</span> <span class="n">true_pf</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sorted_pf</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sorted_pf</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True PF&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nd_solutions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nd_solutions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ND Solutions&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$f_1$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f_2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">n_objectives</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">true_pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">true_pf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">true_pf</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">true_pf</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">true_pf</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                           <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True PF&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">depthshade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nd_solutions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nd_solutions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nd_solutions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                       <span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ND Solutions&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">depthshade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$f_1$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$f_2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$f_3$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Parallel coordinates for many-objective</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nd_solutions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_objectives</span><span class="p">),</span> <span class="n">nd_solutions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                        <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Objective Index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_objectives</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">rf</span><span class="s1">&#39;$f_</span><span class="se">{{</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="se">}}</span><span class="s1">$&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_objectives</span><span class="p">)])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">algo</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">n_tasks</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1"> - Task</span><span class="si">{</span><span class="n">task_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">algo</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">fig</span></div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Main Data Analyzer Class</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="DataAnalyzer">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DataAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main class for comprehensive data analysis and visualization of multi-task optimization experiments.</span>

<span class="sd">    This class provides a complete pipeline for:</span>

<span class="sd">    - Scanning data directories to detect algorithms, problems, and runs</span>
<span class="sd">    - Calculating performance metrics (IGD, HV, or objective values)</span>
<span class="sd">    - Generating statistical comparison tables (Excel or LaTeX)</span>
<span class="sd">    - Creating convergence curve plots</span>
<span class="sd">    - Visualizing runtime comparisons</span>
<span class="sd">    - Plotting non-dominated solutions</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    data_path : Path</span>
<span class="sd">        Path to the data directory containing experiment results.</span>
<span class="sd">    settings : Optional[Dict[str, Any]]</span>
<span class="sd">        Problem settings including reference definitions and metric configuration.</span>
<span class="sd">    algorithm_order : Optional[List[str]]</span>
<span class="sd">        Custom ordering of algorithms for display.</span>
<span class="sd">    table_config : TableConfig</span>
<span class="sd">        Configuration for table generation.</span>
<span class="sd">    plot_config : PlotConfig</span>
<span class="sd">        Configuration for plot generation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;./Data&#39;</span><span class="p">,</span>
            <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">algorithm_order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">save_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;./Results&#39;</span><span class="p">,</span>
            <span class="n">table_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;excel&#39;</span><span class="p">,</span>
            <span class="n">figure_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
            <span class="n">statistic_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="n">significance_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="n">rank_sum_test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">log_scale</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">show_pf</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">show_nd</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">best_so_far</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">clear_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize DataAnalyzer with configuration parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data_path : Union[str, Path], optional</span>
<span class="sd">            Path to data directory containing algorithm subdirectories.</span>
<span class="sd">            Each subdirectory should contain pickle files named: ALGO_problem_run.pkl</span>
<span class="sd">            Default: &#39;./Data&#39;</span>
<span class="sd">        settings : Optional[Dict[str, Any]], optional</span>
<span class="sd">            Problem settings dictionary containing:</span>

<span class="sd">            - Problem names as keys (e.g., &#39;P1&#39;, &#39;P2&#39;)</span>
<span class="sd">            - Task definitions as nested dictionaries</span>
<span class="sd">            - &#39;metric&#39;: str (&#39;IGD&#39; or &#39;HV&#39;)</span>
<span class="sd">            - &#39;ref_path&#39;: str (path to reference files)</span>
<span class="sd">            - &#39;n_ref&#39;: int (number of reference points)</span>

<span class="sd">            Default: None (single-objective mode)</span>
<span class="sd">        algorithm_order : Optional[List[str]], optional</span>
<span class="sd">            Custom ordering of algorithms for display.</span>
<span class="sd">            The last algorithm is used as baseline for statistical tests.</span>
<span class="sd">            Default: None (alphabetical order)</span>
<span class="sd">        save_path : Union[str, Path], optional</span>
<span class="sd">            Directory path to save all output files.</span>
<span class="sd">            Default: &#39;./Results&#39;</span>
<span class="sd">        table_format : str, optional</span>
<span class="sd">            Output table format: &#39;excel&#39; or &#39;latex&#39;.</span>
<span class="sd">            Default: &#39;excel&#39;</span>
<span class="sd">        figure_format : str, optional</span>
<span class="sd">            Output figure format: &#39;pdf&#39;, &#39;png&#39;, &#39;svg&#39;, etc.</span>
<span class="sd">            Default: &#39;pdf&#39;</span>
<span class="sd">        statistic_type : str, optional</span>
<span class="sd">            Type of statistic: &#39;mean&#39;, &#39;median&#39;, &#39;max&#39;, &#39;min&#39;.</span>
<span class="sd">            Default: &#39;mean&#39;</span>
<span class="sd">        significance_level : float, optional</span>
<span class="sd">            P-value threshold for statistical significance testing.</span>
<span class="sd">            Default: 0.05</span>
<span class="sd">        rank_sum_test : bool, optional</span>
<span class="sd">            Whether to perform Wilcoxon rank-sum test.</span>
<span class="sd">            Default: True</span>
<span class="sd">        log_scale : bool, optional</span>
<span class="sd">            Whether to use logarithmic scale for convergence plot y-axis.</span>
<span class="sd">            Default: False</span>
<span class="sd">        show_pf : bool, optional</span>
<span class="sd">            Whether to show true Pareto front in ND solution plots.</span>
<span class="sd">            Default: True</span>
<span class="sd">        show_nd : bool, optional</span>
<span class="sd">            Whether to filter and show only non-dominated solutions.</span>
<span class="sd">            Default: True</span>
<span class="sd">        best_so_far : bool, optional</span>
<span class="sd">            Whether to use best-so-far metric values.</span>
<span class="sd">            Default: True</span>
<span class="sd">        clear_results : bool, optional</span>
<span class="sd">            Whether to clear existing results folder before analysis.</span>
<span class="sd">            Default: True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="o">=</span> <span class="n">algorithm_order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best_so_far</span> <span class="o">=</span> <span class="n">best_so_far</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_results</span> <span class="o">=</span> <span class="n">clear_results</span>

        <span class="c1"># Parse enums</span>
        <span class="n">stat_type</span> <span class="o">=</span> <span class="n">StatisticType</span><span class="p">(</span><span class="n">statistic_type</span><span class="p">)</span>
        <span class="n">tbl_format</span> <span class="o">=</span> <span class="n">TableFormat</span><span class="p">(</span><span class="n">table_format</span><span class="p">)</span>

        <span class="c1"># Initialize configurations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_config</span> <span class="o">=</span> <span class="n">TableConfig</span><span class="p">(</span>
            <span class="n">table_format</span><span class="o">=</span><span class="n">tbl_format</span><span class="p">,</span>
            <span class="n">statistic_type</span><span class="o">=</span><span class="n">stat_type</span><span class="p">,</span>
            <span class="n">significance_level</span><span class="o">=</span><span class="n">significance_level</span><span class="p">,</span>
            <span class="n">rank_sum_test</span><span class="o">=</span><span class="n">rank_sum_test</span><span class="p">,</span>
            <span class="n">save_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_config</span> <span class="o">=</span> <span class="n">PlotConfig</span><span class="p">(</span>
            <span class="n">figure_format</span><span class="o">=</span><span class="n">figure_format</span><span class="p">,</span>
            <span class="n">statistic_type</span><span class="o">=</span><span class="n">stat_type</span><span class="p">,</span>
            <span class="n">log_scale</span><span class="o">=</span><span class="n">log_scale</span><span class="p">,</span>
            <span class="n">show_pf</span><span class="o">=</span><span class="n">show_pf</span><span class="p">,</span>
            <span class="n">show_nd</span><span class="o">=</span><span class="n">show_nd</span><span class="p">,</span>
            <span class="n">save_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Internal state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ScanResult</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MetricResults</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DataAnalyzer.scan_data">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.scan_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">scan_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScanResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scan the data directory to detect algorithms, problems, run counts.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ScanResult</span>
<span class="sd">            Dataclass containing:</span>

<span class="sd">            - algorithms: List[str] - Sorted list of algorithm names</span>
<span class="sd">            - problems: List[str] - Sorted list of problem names</span>
<span class="sd">            - runs: int - Number of independent runs</span>
<span class="sd">            - data_path: Path - Path to scanned directory</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        FileNotFoundError</span>
<span class="sd">            If data_path does not exist.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If no algorithm directories or pickle files found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">algorithms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">problems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">runs_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">algo_dir</span> <span class="ow">in</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()]:</span>
            <span class="n">algo</span> <span class="o">=</span> <span class="n">algo_dir</span><span class="o">.</span><span class="n">name</span>
            <span class="n">algorithms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">algo</span><span class="p">)</span>
            <span class="n">runs_dict</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">pkl</span> <span class="ow">in</span> <span class="n">algo_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.pkl&#39;</span><span class="p">):</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">pkl</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">runs_dict</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pkl</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">prob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">problems</span><span class="p">:</span>
                        <span class="n">problems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

        <span class="n">algorithms</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">problems</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="c1"># problems.sort()</span>

        <span class="n">first_algo</span> <span class="o">=</span> <span class="n">algorithms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">first_prob</span> <span class="o">=</span> <span class="n">problems</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">runs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">runs_dict</span><span class="p">[</span><span class="n">first_algo</span><span class="p">][</span><span class="n">first_prob</span><span class="p">])</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">algorithms</span><span class="p">)</span><span class="si">}</span><span class="s2"> algorithms: </span><span class="si">{</span><span class="n">algorithms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">problems</span><span class="p">)</span><span class="si">}</span><span class="s2"> problems: </span><span class="si">{</span><span class="n">problems</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run times: </span><span class="si">{</span><span class="n">runs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span> <span class="o">=</span> <span class="n">ScanResult</span><span class="p">(</span>
            <span class="n">algorithms</span><span class="o">=</span><span class="n">algorithms</span><span class="p">,</span>
            <span class="n">problems</span><span class="o">=</span><span class="n">problems</span><span class="p">,</span>
            <span class="n">runs</span><span class="o">=</span><span class="n">runs</span><span class="p">,</span>
            <span class="n">data_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span></div>


<div class="viewcode-block" id="DataAnalyzer.calculate_metrics">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.calculate_metrics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MetricResults</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate metric values for all algorithms, problems, and runs.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MetricResults</span>
<span class="sd">            Dataclass containing all computed metrics:</span>

<span class="sd">            - metric_values: Metric values per generation</span>
<span class="sd">            - best_values: Final best metric values</span>
<span class="sd">            - objective_values: Original objective values</span>
<span class="sd">            - runtime: Runtime in seconds</span>
<span class="sd">            - max_nfes: Maximum function evaluations</span>
<span class="sd">            - metric_name: Name of metric used</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If scan_data() has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan_data</span><span class="p">()</span>

        <span class="n">scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span>
        <span class="n">algo_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">else</span> <span class="n">scan</span><span class="o">.</span><span class="n">algorithms</span>
        <span class="n">metric_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;metric&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Initialize storage dictionaries</span>
        <span class="n">all_values</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>
        <span class="n">all_values_best_so_far</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>
        <span class="n">all_best_values</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>
        <span class="n">original_objective_values</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>
        <span class="n">all_runtime</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>
        <span class="n">all_max_nfes</span> <span class="o">=</span> <span class="p">{</span><span class="n">algo</span><span class="p">:</span> <span class="p">{</span><span class="n">prob</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">}</span> <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">}</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">algo_order</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">)</span> <span class="o">*</span> <span class="n">scan</span><span class="o">.</span><span class="n">runs</span>
        <span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Calculating metric values&quot;</span><span class="p">,</span> <span class="n">dynamic_ncols</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="n">algo_order</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">scan</span><span class="o">.</span><span class="n">problems</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">scan</span><span class="o">.</span><span class="n">runs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">pkl_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">algo</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">run</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
                    <span class="n">pkl_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span> <span class="o">/</span> <span class="n">algo</span> <span class="o">/</span> <span class="n">pkl_file</span>

                    <span class="n">data</span> <span class="o">=</span> <span class="n">DataUtils</span><span class="o">.</span><span class="n">load_pickle</span><span class="p">(</span><span class="n">pkl_path</span><span class="p">)</span>
                    <span class="n">metric_values</span><span class="p">,</span> <span class="n">metric_values_best_bs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_single_run_metric_value</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>

                    <span class="n">all_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">metric_values</span>
                    <span class="n">all_values_best_so_far</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">metric_values_best_bs</span>

                    <span class="n">last_vals</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">task_arr</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_arr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                        <span class="k">for</span> <span class="n">task_arr</span> <span class="ow">in</span> <span class="n">metric_values_best_bs</span>
                    <span class="p">]</span>
                    <span class="n">all_best_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_vals</span>

                    <span class="n">last_objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;all_objs&#39;</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;all_objs&#39;</span><span class="p">]))]</span>
                    <span class="n">original_objective_values</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_objs</span>

                    <span class="n">all_runtime</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">][</span><span class="n">run</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;runtime&#39;</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">all_max_nfes</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">all_max_nfes</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">prob</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;max_nfes&#39;</span><span class="p">]</span>

                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">selected</span> <span class="o">=</span> <span class="n">all_values_best_so_far</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_so_far</span> <span class="k">else</span> <span class="n">all_values</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span> <span class="o">=</span> <span class="n">MetricResults</span><span class="p">(</span>
            <span class="n">metric_values</span><span class="o">=</span><span class="n">selected</span><span class="p">,</span>
            <span class="n">best_values</span><span class="o">=</span><span class="n">all_best_values</span><span class="p">,</span>
            <span class="n">objective_values</span><span class="o">=</span><span class="n">original_objective_values</span><span class="p">,</span>
            <span class="n">runtime</span><span class="o">=</span><span class="n">all_runtime</span><span class="p">,</span>
            <span class="n">max_nfes</span><span class="o">=</span><span class="n">all_max_nfes</span><span class="p">,</span>
            <span class="n">metric_name</span><span class="o">=</span><span class="n">metric_name</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_get_single_run_metric_value</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
            <span class="n">prob</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate metric values for a single run.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : Dict[str, Any]</span>
<span class="sd">            Loaded pickle data containing &#39;all_objs&#39; key.</span>
<span class="sd">        prob : str</span>
<span class="sd">            Problem name for loading references.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Tuple[List[np.ndarray], List[np.ndarray]]</span>
<span class="sd">            Tuple of (metric_values, metric_values_best_so_far).</span>
<span class="sd">            Each is a list of arrays, one per task.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_decs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;all_decs&#39;</span><span class="p">]</span>
        <span class="n">all_objs</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;all_objs&#39;</span><span class="p">]</span>
        <span class="n">all_cons</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;all_cons&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">n_tasks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_objs</span><span class="p">)</span>
        <span class="n">n_gens_per_task</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">all_objs</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">)]</span>

        <span class="n">metric_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_gens_per_task</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">)]</span>
        <span class="n">metric_values_best_so_far</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_gens_per_task</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_tasks</span><span class="p">):</span>
            <span class="n">task_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;T</span><span class="si">{</span><span class="n">t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">best_so_far</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">reference</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_gens_per_task</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="n">M</span> <span class="o">=</span> <span class="n">all_objs</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">D</span> <span class="o">=</span> <span class="n">all_decs</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">C</span> <span class="o">=</span> <span class="n">all_cons</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">all_cons</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

                <span class="n">reference</span> <span class="o">=</span> <span class="n">DataUtils</span><span class="o">.</span><span class="n">load_reference</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span>
                    <span class="n">prob</span><span class="p">,</span>
                    <span class="n">task_key</span><span class="p">,</span>
                    <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span>
                    <span class="n">D</span><span class="o">=</span><span class="n">D</span><span class="p">,</span>
                    <span class="n">C</span><span class="o">=</span><span class="n">C</span>
                <span class="p">)</span>

            <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_gens_per_task</span><span class="p">[</span><span class="n">t</span><span class="p">]):</span>
                <span class="n">objs_tgen</span> <span class="o">=</span> <span class="n">all_objs</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">gen</span><span class="p">]</span>
                <span class="n">cons_tgen</span> <span class="o">=</span> <span class="n">all_cons</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">gen</span><span class="p">]</span> <span class="k">if</span> <span class="n">all_cons</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">objs_tgen</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">metric_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Multi-objective metric calculation requires settings parameter&#39;</span><span class="p">)</span>

                    <span class="n">metric_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;metric&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;IGD&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">IGD</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;HV&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">HV</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;IGDp&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">IGDp</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;GD&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">GD</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;DeltaP&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">DeltaP</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;Spacing&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">Spacing</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;Spread&#39;</span><span class="p">:</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">Spread</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">objs_tgen</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;FR&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cons_tgen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;FR metric requires constraint data, but all_cons is not available&#39;</span><span class="p">)</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">FR</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">cons_tgen</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">elif</span> <span class="n">metric_name</span> <span class="o">==</span> <span class="s1">&#39;CV&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">cons_tgen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;CV metric requires constraint data, but all_cons is not available&#39;</span><span class="p">)</span>
                        <span class="n">metric_instance</span> <span class="o">=</span> <span class="n">CV</span><span class="p">()</span>
                        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">cons_tgen</span><span class="p">)</span>
                        <span class="n">sign</span> <span class="o">=</span> <span class="n">metric_instance</span><span class="o">.</span><span class="n">sign</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unsupported metric: </span><span class="si">{</span><span class="n">metric_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">metric_values</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">gen</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">metric_value</span>

                <span class="k">if</span> <span class="n">best_so_far</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">best_so_far</span> <span class="o">=</span> <span class="n">metric_value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">best_so_far</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">best_so_far</span><span class="p">,</span> <span class="n">metric_value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">best_so_far</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">best_so_far</span><span class="p">,</span> <span class="n">metric_value</span><span class="p">)</span>

                <span class="n">metric_values_best_so_far</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">gen</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_so_far</span>

        <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">metric_values_best_so_far</span>

<div class="viewcode-block" id="DataAnalyzer.generate_tables">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.generate_tables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate comparison tables with statistical analysis.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[pd.DataFrame, str]</span>
<span class="sd">            DataFrame for Excel format, LaTeX string for LaTeX format.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If calculate_metrics() has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="n">algo_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span><span class="o">.</span><span class="n">algorithms</span>

        <span class="n">table_gen</span> <span class="o">=</span> <span class="n">TableGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table_config</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">table_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">best_values</span><span class="p">,</span>
            <span class="n">algo_order</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">metric_name</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataAnalyzer.generate_convergence_plots">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.generate_convergence_plots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_convergence_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save convergence curve plots.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figures to disk at configured save_path.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If calculate_metrics() has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="n">algo_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span><span class="o">.</span><span class="n">algorithms</span>

        <span class="n">plot_gen</span> <span class="o">=</span> <span class="n">PlotGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_config</span><span class="p">)</span>
        <span class="n">plot_gen</span><span class="o">.</span><span class="n">plot_convergence_curves</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">metric_values</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">best_values</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">max_nfes</span><span class="p">,</span>
            <span class="n">algo_order</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">metric_name</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataAnalyzer.generate_runtime_plots">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.generate_runtime_plots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_runtime_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save runtime comparison bar plots.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figure to disk at configured save_path.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If calculate_metrics() has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="n">algo_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span><span class="o">.</span><span class="n">algorithms</span>

        <span class="n">plot_gen</span> <span class="o">=</span> <span class="n">PlotGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_config</span><span class="p">)</span>
        <span class="n">plot_gen</span><span class="o">.</span><span class="n">plot_runtime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">runtime</span><span class="p">,</span> <span class="n">algo_order</span><span class="p">)</span></div>


<div class="viewcode-block" id="DataAnalyzer.generate_nd_solution_plots">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.generate_nd_solution_plots">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_nd_solution_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate and save non-dominated solution visualization plots.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            Saves figures to disk at configured save_path/ND_Solutions/.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        RuntimeError</span>
<span class="sd">            If calculate_metrics() has not been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="n">algo_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm_order</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scan_result</span><span class="o">.</span><span class="n">algorithms</span>

        <span class="n">plot_gen</span> <span class="o">=</span> <span class="n">PlotGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_config</span><span class="p">)</span>
        <span class="n">plot_gen</span><span class="o">.</span><span class="n">plot_nd_solutions</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">best_values</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span><span class="o">.</span><span class="n">objective_values</span><span class="p">,</span>
            <span class="n">algo_order</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DataAnalyzer.run">
<a class="viewcode-back" href="../../../api.html#ddmtolab.Methods.data_analysis.DataAnalyzer.run">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MetricResults</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute the complete analysis pipeline.</span>

<span class="sd">        This method runs all analysis steps in sequence:</span>

<span class="sd">        1. Clear existing results (if configured)</span>
<span class="sd">        2. Scan data directory</span>
<span class="sd">        3. Calculate metrics</span>
<span class="sd">        4. Generate statistical tables</span>
<span class="sd">        5. Generate convergence plots</span>
<span class="sd">        6. Generate runtime plots</span>
<span class="sd">        7. Generate non-dominated solution plots</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        MetricResults</span>
<span class="sd">            Complete metric results from the analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Starting Data Analysis Pipeline! &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="c1"># Step 0: Clear results folder if requested</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_results</span><span class="p">:</span>
            <span class="n">results_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_config</span><span class="o">.</span><span class="n">save_path</span>
            <span class="k">if</span> <span class="n">results_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  Clearing existing results folder: </span><span class="si">{</span><span class="n">results_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">results_path</span><span class="p">)</span>
            <span class="n">results_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Step 1: Scan data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Scanning data directory...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_data</span><span class="p">()</span>

        <span class="c1"># Step 2: Calculate metrics</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Calculating metric values...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="c1"># Step 3: Generate tables</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Generating statistical tables...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_tables</span><span class="p">()</span>

        <span class="c1"># Step 4: Plot convergence curves</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Plotting convergence curves...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_convergence_plots</span><span class="p">()</span>

        <span class="c1"># Step 5: Plot runtime</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Plotting runtime comparison...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_runtime_plots</span><span class="p">()</span>

        <span class="c1"># Step 6: Plot non-dominated solutions</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Plotting non-dominated solutions...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_nd_solution_plots</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Data Analysis Completed! &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metric_results</span></div>
</div>



<span class="c1"># =============================================================================</span>
<span class="c1"># Module Entry Point and Usage Examples</span>
<span class="c1"># =============================================================================</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Usage Examples for DataAnalyzer Module</span>
<span class="sd">    ======================================</span>

<span class="sd">    This module provides a comprehensive analysis pipeline for multi-task </span>
<span class="sd">    optimization experiments. Below are various usage patterns.</span>


<span class="sd">    Example 1: Quick Start - Full Pipeline</span>
<span class="sd">    --------------------------------------</span>
<span class="sd">    Run complete analysis with default settings::</span>

<span class="sd">        from data_analyzer import DataAnalyzer</span>

<span class="sd">        analyzer = DataAnalyzer(data_path=&#39;./Data&#39;)</span>
<span class="sd">        results = analyzer.run()</span>


<span class="sd">    Example 2: Multi-Objective Optimization with Custom Settings</span>
<span class="sd">    ------------------------------------------------------------</span>
<span class="sd">    Analyze multi-objective results with IGD metric::</span>

<span class="sd">        from data_analyzer import DataAnalyzer</span>

<span class="sd">        # Define problem settings with Pareto front references</span>
<span class="sd">        SETTINGS = {</span>
<span class="sd">            &#39;metric&#39;: &#39;IGD&#39;,</span>
<span class="sd">            &#39;ref_path&#39;: &#39;./MOReference&#39;,</span>
<span class="sd">            &#39;n_ref&#39;: 10000,</span>
<span class="sd">            &#39;P1&#39;: {</span>
<span class="sd">                &#39;T1&#39;: &#39;P1_T1_ref.npy&#39;,</span>
<span class="sd">                &#39;T2&#39;: &#39;P1_T2_ref.npy&#39;,</span>
<span class="sd">            },</span>
<span class="sd">            &#39;P2&#39;: {</span>
<span class="sd">                &#39;T1&#39;: lambda n, m: generate_pf(n, m),  # Callable reference</span>
<span class="sd">            }</span>
<span class="sd">        }</span>

<span class="sd">        analyzer = DataAnalyzer(</span>
<span class="sd">            data_path=&#39;./Data&#39;,</span>
<span class="sd">            settings=SETTINGS,</span>
<span class="sd">            save_path=&#39;./Results&#39;,</span>
<span class="sd">            table_format=&#39;latex&#39;,</span>
<span class="sd">            figure_format=&#39;pdf&#39;</span>
<span class="sd">        )</span>
<span class="sd">        results = analyzer.run()</span>


<span class="sd">    Example 3: Step-by-Step Analysis</span>
<span class="sd">    --------------------------------</span>
<span class="sd">    Execute individual analysis steps for fine-grained control::</span>

<span class="sd">        from data_analyzer import DataAnalyzer</span>

<span class="sd">        analyzer = DataAnalyzer(</span>
<span class="sd">            data_path=&#39;./Data&#39;,</span>
<span class="sd">            settings=SETTINGS,</span>
<span class="sd">            algorithm_order=[&#39;NSGA-II&#39;, &#39;MOEA/D&#39;, &#39;MyAlgo&#39;],  # Last is baseline</span>
<span class="sd">            clear_results=False</span>
<span class="sd">        )</span>

<span class="sd">        # Step 1: Scan data directory</span>
<span class="sd">        scan_result = analyzer.scan_data()</span>
<span class="sd">        print(f&quot;Found algorithms: {scan_result.algorithms}&quot;)</span>
<span class="sd">        print(f&quot;Found problems: {scan_result.problems}&quot;)</span>

<span class="sd">        # Step 2: Calculate metrics</span>
<span class="sd">        metric_results = analyzer.calculate_metrics()</span>

<span class="sd">        # Step 3: Generate only specific outputs</span>
<span class="sd">        analyzer.generate_tables()           # Statistical comparison tables</span>
<span class="sd">        analyzer.generate_convergence_plots() # Convergence curves</span>
<span class="sd">        analyzer.generate_runtime_plots()     # Runtime bar charts</span>
<span class="sd">        analyzer.generate_nd_solution_plots() # Pareto front visualizations</span>


<span class="sd">    Example 4: Custom Table Generation</span>
<span class="sd">    ----------------------------------</span>
<span class="sd">    Generate tables with specific statistical settings::</span>

<span class="sd">        from data_analyzer import (</span>
<span class="sd">            DataAnalyzer, TableGenerator, TableConfig, </span>
<span class="sd">            TableFormat, StatisticType</span>
<span class="sd">        )</span>

<span class="sd">        # Create custom table configuration</span>
<span class="sd">        table_config = TableConfig(</span>
<span class="sd">            table_format=TableFormat.LATEX,</span>
<span class="sd">            statistic_type=StatisticType.MEDIAN,</span>
<span class="sd">            significance_level=0.01,</span>
<span class="sd">            rank_sum_test=True,</span>
<span class="sd">            save_path=Path(&#39;./CustomResults&#39;)</span>
<span class="sd">        )</span>

<span class="sd">        # Use with analyzer</span>
<span class="sd">        analyzer = DataAnalyzer(data_path=&#39;./Data&#39;, settings=SETTINGS)</span>
<span class="sd">        analyzer.scan_data()</span>
<span class="sd">        analyzer.calculate_metrics()</span>

<span class="sd">        # Generate table with custom config</span>
<span class="sd">        table_gen = TableGenerator(table_config)</span>
<span class="sd">        latex_table = table_gen.generate(</span>
<span class="sd">            analyzer._metric_results.best_values,</span>
<span class="sd">            algorithm_order=[&#39;Algo1&#39;, &#39;Algo2&#39;, &#39;Baseline&#39;],</span>
<span class="sd">            metric_name=&#39;IGD&#39;</span>
<span class="sd">        )</span>


<span class="sd">    Example 5: Custom Plot Generation</span>
<span class="sd">    ---------------------------------</span>
<span class="sd">    Create plots with specific visual settings::</span>

<span class="sd">        from data_analyzer import DataAnalyzer, PlotGenerator, PlotConfig, StatisticType</span>

<span class="sd">        # Create custom plot configuration</span>
<span class="sd">        plot_config = PlotConfig(</span>
<span class="sd">            figure_format=&#39;png&#39;,</span>
<span class="sd">            statistic_type=StatisticType.MEDIAN,</span>
<span class="sd">            log_scale=True,</span>
<span class="sd">            show_pf=True,</span>
<span class="sd">            show_nd=True,</span>
<span class="sd">            save_path=Path(&#39;./Figures&#39;),</span>
<span class="sd">            colors=[&#39;#E41A1C&#39;, &#39;#377EB8&#39;, &#39;#4DAF4A&#39;],  # Custom colors</span>
<span class="sd">            markers=[&#39;o&#39;, &#39;s&#39;, &#39;^&#39;]</span>
<span class="sd">        )</span>

<span class="sd">        analyzer = DataAnalyzer(data_path=&#39;./Data&#39;, settings=SETTINGS)</span>
<span class="sd">        analyzer.calculate_metrics()</span>

<span class="sd">        # Generate plots with custom config</span>
<span class="sd">        plot_gen = PlotGenerator(plot_config)</span>
<span class="sd">        plot_gen.plot_convergence_curves(</span>
<span class="sd">            analyzer._metric_results.metric_values,</span>
<span class="sd">            analyzer._metric_results.best_values,</span>
<span class="sd">            analyzer._metric_results.max_nfes,</span>
<span class="sd">            algorithm_order=[&#39;Algo1&#39;, &#39;Algo2&#39;],</span>
<span class="sd">            metric_name=&#39;IGD&#39;</span>
<span class="sd">        )</span>


<span class="sd">    Example 6: Access Raw Results</span>
<span class="sd">    -----------------------------</span>
<span class="sd">    Access computed metrics for custom analysis::</span>

<span class="sd">        from data_analyzer import DataAnalyzer</span>

<span class="sd">        analyzer = DataAnalyzer(data_path=&#39;./Data&#39;, settings=SETTINGS)</span>
<span class="sd">        results = analyzer.run()</span>

<span class="sd">        # Access metric values</span>
<span class="sd">        # Structure: results.metric_values[algo][problem][run][task_idx]</span>
<span class="sd">        algo1_p1_run1_task0 = results.metric_values[&#39;Algo1&#39;][&#39;P1&#39;][1][0]</span>

<span class="sd">        # Access best values</span>
<span class="sd">        # Structure: results.best_values[algo][problem][run] = [task0_val, task1_val, ...]</span>
<span class="sd">        best_vals = results.best_values[&#39;Algo1&#39;][&#39;P1&#39;][1]</span>

<span class="sd">        # Access objective values (Pareto solutions)</span>
<span class="sd">        # Structure: results.objective_values[algo][problem][run][task_idx] = np.ndarray</span>
<span class="sd">        pareto_solutions = results.objective_values[&#39;Algo1&#39;][&#39;P1&#39;][1][0]</span>

<span class="sd">        # Access runtime</span>
<span class="sd">        runtime_seconds = results.runtime[&#39;Algo1&#39;][&#39;P1&#39;][1]</span>

<span class="sd">        # Access max NFEs per task</span>
<span class="sd">        max_nfes_list = results.max_nfes[&#39;Algo1&#39;][&#39;P1&#39;]</span>


<span class="sd">    Example 7: Using Utility Classes Directly</span>
<span class="sd">    -----------------------------------------</span>
<span class="sd">    Use statistics and data utilities independently::</span>

<span class="sd">        from data_analyzer import (</span>
<span class="sd">            StatisticsCalculator, DataUtils, </span>
<span class="sd">            StatisticType, OptimizationDirection</span>
<span class="sd">        )</span>
<span class="sd">        import numpy as np</span>

<span class="sd">        # Calculate statistics</span>
<span class="sd">        data = [1.2, 1.5, 1.1, 1.3, 1.4]</span>
<span class="sd">        mean, std = StatisticsCalculator.calculate_statistic(data, StatisticType.MEAN)</span>

<span class="sd">        # Perform statistical comparison</span>
<span class="sd">        algo_data = [1.0, 1.1, 0.9, 1.2]</span>
<span class="sd">        base_data = [2.0, 2.1, 1.9, 2.2]</span>
<span class="sd">        result = StatisticsCalculator.perform_rank_sum_test(</span>
<span class="sd">            algo_data, base_data,</span>
<span class="sd">            significance_level=0.05,</span>
<span class="sd">            direction=OptimizationDirection.MINIMIZE</span>
<span class="sd">        )</span>
<span class="sd">        print(f&quot;Comparison: {result.symbol}, p-value: {result.p_value}&quot;)</span>

<span class="sd">        # Load reference data</span>
<span class="sd">        reference = DataUtils.load_reference(</span>
<span class="sd">            settings=SETTINGS,</span>
<span class="sd">            problem=&#39;P1&#39;,</span>
<span class="sd">            task_identifier=0,  # or &#39;T1&#39;</span>
<span class="sd">            n_objectives=2</span>
<span class="sd">        )</span>


<span class="sd">    Data Directory Structure</span>
<span class="sd">    ------------------------</span>
<span class="sd">    Expected directory structure for input data::</span>

<span class="sd">        ./Data/</span>
<span class="sd">         Algorithm1/</span>
<span class="sd">            Algorithm1_Problem1_1.pkl</span>
<span class="sd">            Algorithm1_Problem1_2.pkl</span>
<span class="sd">            Algorithm1_Problem2_1.pkl</span>
<span class="sd">            ...</span>
<span class="sd">         Algorithm2/</span>
<span class="sd">            Algorithm2_Problem1_1.pkl</span>
<span class="sd">            ...</span>
<span class="sd">         ...</span>

<span class="sd">    Each .pkl file should contain a dictionary with keys:</span>

<span class="sd">    - &#39;all_objs&#39;: List[List[np.ndarray]] - Objectives per task per generation</span>
<span class="sd">    - &#39;runtime&#39;: float - Total runtime in seconds</span>
<span class="sd">    - &#39;max_nfes&#39;: List[int] - Max function evaluations per task</span>


<span class="sd">    Output Structure</span>
<span class="sd">    ----------------</span>
<span class="sd">    Generated output files::</span>

<span class="sd">        ./Results/</span>
<span class="sd">         results_table_mean.xlsx      # or .tex for LaTeX</span>
<span class="sd">         Problem1.pdf                 # Convergence plot (single task)</span>
<span class="sd">         Problem2-Task1.pdf           # Convergence plot (multi-task)</span>
<span class="sd">         Problem2-Task2.pdf</span>
<span class="sd">         runtime_comparison.pdf       # Runtime bar chart</span>
<span class="sd">         ND_Solutions/</span>
<span class="sd">             Problem1-Algorithm1.pdf  # Pareto front plot</span>
<span class="sd">             Problem1-Algorithm2.pdf</span>
<span class="sd">             ...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Demo: Run analysis with sample configuration</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataAnalyzer Module - Demo Run&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

    <span class="c1"># Example configuration (modify paths as needed)</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">DataAnalyzer</span><span class="p">(</span>
        <span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;./Data&#39;</span><span class="p">,</span>
        <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;./Results&#39;</span><span class="p">,</span>
        <span class="n">table_format</span><span class="o">=</span><span class="s1">&#39;excel&#39;</span><span class="p">,</span>
        <span class="n">figure_format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
        <span class="n">statistic_type</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
        <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
        <span class="n">rank_sum_test</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">log_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_pf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">show_nd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">clear_results</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Run complete analysis pipeline</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jiangtao Shen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>